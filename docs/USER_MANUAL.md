# SyncFlow 用户使用手册

## 目录

1. [系统概述](#系统概述)
2. [仪表盘](#仪表盘)
3. [订单管理](#订单管理)
4. [排产控制](#排产控制)
5. [仓库作业](#仓库作业)
6. [AI助手](#ai助手)
7. [系统设置](#系统设置)
8. [常见问题](#常见问题)

---

## 系统概述

SyncFlow 是一个智能产销协同平台，帮助企业高效管理库存、订单与产线。

### 核心功能

| 模块 | 功能 | 说明 |
|------|------|------|
| 仪表盘 | 数据总览 | 实时监控关键指标、大单预警、库存健康度、发货排程 |
| 订单管理 | 订单全生命周期 | Excel/AI导入、状态流转、日历视图、打印装箱单 |
| 排产控制 | 产线/款号管理 | 分支产能配置（大管/小管）、款号维护、变更历史 |
| 仓库作业 | 库存与发货 | 入库/出库、库存分级、装车确认、异常登记 |
| AI助手 | 智能分析 | 排产建议、库存分析、发货排序、自然语言查询 |
| 系统设置 | 配置管理 | 主题切换、AI服务商配置、数据备份恢复 |

### 界面布局

- **左侧边栏**: 导航菜单，点击 ☰ 按钮可收缩
- **顶部**: 当前模块标题、全屏切换、主题切换、设置按钮
- **主内容区**: 各模块功能界面
- **右下角**: AI助手入口（蓝色机器人按钮）

### 快捷键

| 快捷键 | 功能 |
|--------|------|
| Alt + 1~5 | 切换页面（仪表盘/订单/排产/仓库/帮助） |
| Alt + D | 切换深色/浅色模式 |
| Alt + A | 打开AI助手 |

---

## 仪表盘

### 关键指标卡片

顶部显示4个核心指标：
- **活跃订单**: 待处理订单数量（不含已出货）
- **待发吨数**: 未发货订单总吨数
- **运行产线**: 当前运行中的产线数 / 总产线数
- **紧急预警**: 需要关注的大单预警数量

### 大单预警区

- 红色闪烁区域显示超过100吨的大订单
- 显示客户名称、需求吨数、款号
- 需要在订单管理中点击"确认大货"按钮确认已知悉

### 库存健康度面板

右侧面板显示各款号库存覆盖率：
- **绿色**: 库存充足，覆盖率 ≥100%
- **红色**: 库存不足，显示缺口吨数
- 覆盖率 = (可用库存 + 今日产能) / 订单需求 × 100%

### 发货排程看板

分为两个区域：
- **今日发货**: 当天需要装车的订单，显示装货时段（上午/下午/灵活）和车间沟通状态
- **即将发货**: 未来几天的发货计划，显示预计发货日期和提前备货天数

### 异常记录表

底部显示未处理的异常记录：
- 时间、款号、上报人、异常原因、备注
- 在仓库作业模块可处理或删除异常

---

## 订单管理

### 视图切换

订单管理支持三种视图：
- **表格视图**: 传统列表形式，支持虚拟滚动优化大量数据
- **日历视图**: 按预计发货日期显示订单，支持月/周切换，可拖拽调整日期
- **客户管理**: 客户信息维护、统计分析、历史订单查看

### 标签页筛选

表格视图下分为三个标签页：
- **待处理**: 显示所有未出货订单（待处理、生产中、齐料待发）
- **待发货**: 仅显示齐料待发状态的订单
- **已出货**: 显示已完成发货的订单

### 订单状态流转

| 状态 | 说明 | 切换条件 |
|------|------|----------|
| 待处理 | 新订单默认状态 | 无限制 |
| 生产中 | 订单已安排生产 | 无限制 |
| 齐料待发 | 物料齐全待发货 | 满足率 ≥100% |
| 已出货 | 订单已发货完成 | 满足率 ≥100% |

> **重要**: 库存满足率不足100%时，无法切换到"齐料待发"和"已出货"状态

### 导入订单

#### 方式一: Excel导入

1. 点击绿色"导入订单"按钮
2. 选择"粘贴数据"或"上传文件"
3. Excel列顺序（共14列，含序号）：
   ```
   序号 | 日期 | 客户 | 款号 | PI号 | 产线 | 提单号 | 总量(t) | 柜数 | 包/柜 | 港口 | 对接人 | 贸易类型 | 装货要求
   ```
4. 上传文件支持拖拽放入
5. 点击"解析预览"检查数据
6. 确认无误后点击"确认导入"

> **提示**: 产线列支持多产线格式，如"1/2"或"1,2"表示分配到1号和2号产线

#### 方式二: AI智能导入

1. 点击紫色"从聊天导入(AI)"按钮
2. 粘贴商务群聊文本或邮件内容
3. AI自动提取订单信息（客户、款号、吨数、日期等）
4. 确认后添加到系统

### 订单列表功能

| 列 | 说明 |
|----|------|
| 日期 | 出货日期 |
| 客户 | 客户名称，大单显示红色"大货"标签 |
| 款号 | 产品款号，显示分配产线编号 |
| 总量 | 订单吨数 |
| 柜数 | 集装箱数量 |
| 港口 | 目的港 |
| 状态 | 订单状态（下拉可切换） |
| 满足率 | 库存满足订单的百分比（进度条+数值） |
| 操作 | 打印、编辑、删除、展开详情 |

**底部合计**: 显示当前筛选订单的总数、总吨数、总柜数

### 订单详情

点击订单行可展开详情，显示：
- PI号、提单号、包/柜、对接人
- 贸易类型（一般贸易/保税）
- 装货时段（上午/下午/灵活）
- 装货要求

### 打印装箱单

点击打印图标可生成装箱单，包含：
- 订单基本信息
- 库存明细（优等品/一等品）
- 打印时间

### 日历视图功能

- **月视图/周视图**: 点击顶部按钮切换
- **今天按钮**: 快速跳转到当天
- **订单显示**: 按预计发货日期显示，颜色表示状态
- **拖拽调整**: 可拖拽订单到其他日期
- **新建订单**: 点击日期格子右上角的 + 号
- **每日吨数**: 显示当天订单总吨数

### 客户管理

切换到"客户管理"视图，可进行客户信息维护和数据分析。

#### 客户列表（左侧）

- **搜索**: 按客户名称或联系人搜索
- **同步按钮**: 从订单中自动提取客户，新客户自动创建
- **添加按钮**: 手动添加新客户
- **客户数量**: 底部显示当前客户总数

#### 客户详情（右侧）

选中客户后显示详细信息：

1. **基本信息**
   - 客户名称、联系人、电话
   - 编辑和删除按钮

2. **统计卡片**
   - 订单数量: 该客户的历史订单总数
   - 总吨数: 累计订购吨数
   - 首次下单: 第一笔订单日期
   - 最近下单: 最后一笔订单日期

3. **常购款号**
   - 显示该客户最常购买的款号
   - 按购买吨数排序

4. **历史订单**
   - 显示该客户的所有订单记录
   - 包含日期、款号、PI号、吨数、柜数、港口

#### 客户字段

| 字段 | 说明 | 必填 |
|------|------|------|
| 客户名称 | 客户公司名称 | ✓ |
| 联系人 | 主要联系人姓名 | |
| 电话 | 联系电话 | |
| 邮箱 | 电子邮箱 | |
| 地址 | 公司地址 | |
| 备注 | 其他说明 | |

### 订单表格排序

表格视图支持多列排序：
- **可排序列**: 日期、客户、款号、总量
- **单击**: 单列排序（升序→降序→取消）
- **Shift+点击**: 多列排序，显示排序优先级数字

### 订单导入拖拽

上传文件模式支持拖拽：
- 将Excel文件直接拖入上传区域
- 拖拽时边框变为绿色提示
- 支持 .xlsx 和 .xls 格式

### 订单导出

点击"导出"按钮导出当前订单列表：
- 导出格式与导入格式一致
- 列顺序: 序号、日期、客户、款号、PI号、产线、提单号、总量(t)、柜数、包/柜、港口、对接人、贸易类型、装货要求
- 字体: Calibri，表头居中加粗
- 客户、款号、PI号、提单号、装货要求列左对齐，其他列居中

---

## 排产控制

### 顶部总览卡片

显示关键生产指标（实时更新）：
- **总产线数**: 系统中的产线总数
- **运行中**: 当前运行的产线数
- **总产能/日**: 运行产线的日产能合计（含分支）
- **外贸可用/日**: 可用于外贸的产能合计
- **款号数量**: 款号维护表中的款号数

### 款号产能分布

可折叠面板，点击展开查看每个在产款号的详情：
- **产线数**: 生产该款号的产线/分支数量
- **总产能**: 该款号的日产能合计
- **外贸可用**: 可用于外贸的产能
- **产线列表**: 具体哪些产线/分支在生产

### 产线管理

#### 产线卡片

每个产线显示：
- 产线名称和状态指示灯（绿色运行/黄色维护/灰色停机）
- 分支图标（有分支时显示）
- 当前款号（多分支显示为 款号1/款号2）
- 产能和外贸产能
- 历史按钮（查看款号变更记录）
- 删除按钮

#### 编辑产线

点击产线卡片进入编辑弹窗：

1. **基本设置**
   - 产线名称
   - 状态: 运行中 / 维护中 / 停机

2. **无分支模式**
   - 款号: 从款号维护表选择
   - 产能(t): 日产能
   - 外贸(t): 外贸可用产能

3. **分支模式**
   - 点击"+大管"或"+小管"添加分支
   - 每个分支独立设置：名称、款号、产能、外贸产能
   - 点击分支右上角 × 删除分支
   - 主线产能 = 分支产能之和
   - 最多两个分支（大管+小管）

4. **生产入库**
   - 当分支有外贸产能时，显示"完成入库"按钮
   - 点击后将外贸产能转入库存，并清零该分支外贸产能

#### 款号变更历史

点击"历史"按钮查看：
- 主线变更: `旧款号 → 新款号`
- 分支变更: `大管:旧款号 → 大管:新款号`
- 变更时间精确到分钟

### 款号维护

切换到"款号维护"标签页：

| 字段 | 说明 | 必填 |
|------|------|------|
| 款号 | 产品编号 | ✓ |
| 名称 | 产品名称 | |
| 分类 | 产品分类（如A类/B类） | |
| 单位重量 | 每件重量(kg) | |
| 备注 | 其他说明 | |

> **提示**: 产线使用的款号会自动添加到款号维护表

---

## 仓库作业

### 标签页切换

仓库作业分为三个标签页：
- **库存管理**: 查看和管理成品库存
- **待装车**: 显示齐料待发的订单
- **异常记录**: 查看和处理异常日志

### 待入库

当产线有外贸产能时，会显示"待入库"标签页：
- 显示各产线/分支的待入库数量
- 点击"确认入库"将产能转入库存
- 入库完成后自动清零产线外贸产能
- 无待入库数据时此标签页自动隐藏

### 库存管理

#### 库存筛选

顶部提供筛选功能：
- **款号搜索**: 输入款号关键字筛选
- **仓库类型**: 全部/一般贸易库/保税库
- **包装规格**: 全部/820kg/750kg/25kg

#### 库存预警

当库存低于安全库存阈值时，顶部会显示预警提示：
- 红色警告框显示低于安全库存的款号
- 点击可快速设置安全库存阈值

#### 库存列表

| 列 | 说明 |
|----|------|
| 款号 | 产品款号 |
| 仓库类型 | 一般贸易库/保税库 |
| 包装规格 | 820kg/750kg/25kg |
| 优等品 | A级库存（吨） |
| 一等品 | B级库存（吨） |
| 当前库存 | 总库存 = 优等品 + 一等品 |
| 操作 | 入库、出库、编辑、流水、锁定、安全库存 |

#### 库存操作

1. **入库**（绿色 + 按钮）
   - 选择等级、输入数量
   - 填写来源和备注（可选）

2. **出库**（橙色 - 按钮）
   - 选择等级、输入数量
   - 填写来源和备注（可选）
   - 库存不足时会提示错误

3. **编辑/盘点调整**（铅笔按钮）
   - 直接修改优等品和一等品数量
   - 用于库存盘点调整
   - 自动记录盘点入库/盘点出库流水

4. **流水**（历史按钮）
   - 查看该款号的入库/出库记录
   - 显示类型（入库/出库/盘点入库/盘点出库）、规格、等级、数量、余额、时间

5. **库存锁定**（锁定按钮）
   - 锁定部分库存，预留给特定订单
   - 正数锁定，负数解锁
   - 可填写锁定原因

6. **安全库存**（设置按钮）
   - 设置安全库存阈值
   - 低于阈值时触发预警提醒

#### 审计日志

点击"日志"按钮查看库存审计记录：
- 记录所有盘点调整、锁定、解锁操作
- 显示时间、款号、规格、操作类型、变更前后数值、原因

#### 库存导出

点击"导出"按钮导出Excel文件：
- 导出当前筛选条件下的库存数据
- 包含款号、仓库类型、包装规格、优等品、一等品、总库存、已锁定、安全库存
- 仓库类型自动转换为中文显示

### 待装车

显示所有齐料待发状态的订单：
- 客户、款号、吨数、柜数、港口
- 装货时段（上午/下午/灵活）
- 车间沟通状态

#### 操作按钮

- **异常上报**: 登记发货异常
- **确认装车**: 确认发货完成，订单状态变为"已出货"

### 异常记录

显示所有异常日志：

| 列 | 说明 |
|----|------|
| 时间 | 异常发生时间 |
| 款号 | 相关款号 |
| 客户 | 相关客户 |
| 原因 | 异常类型（库存被取用/产线延迟/质量问题） |
| 备注 | 详细说明 |
| 状态 | 待处理/已处理 |
| 操作 | 标记处理/重新打开/删除 |

---

## AI助手

### 打开AI助手

点击页面右下角的蓝色机器人按钮，或使用快捷键 Alt + A

### 快捷分析

| 功能 | 说明 |
|------|------|
| 排产建议 | 分析订单、产线、库存数据，给出产线分配和产能优化建议 |
| 库存分析 | 预测库存缺口，分析哪些款号库存紧张，建议补货优先级 |
| 异常分析 | 总结异常记录的问题模式，分析根本原因，提出改进建议 |
| 发货排序 | 根据交期、大单、库存情况智能排定发货优先级 |

### 自然语言查询

在底部输入框直接输入问题，例如：
- "BE3250库存够吗？"
- "今天有哪些订单要发？"
- "哪条产线产能最高？"
- "大单有哪些？"
- "1号线在生产什么？"

AI会根据系统实时数据给出精准回答。

### AI服务商配置

如果默认AI服务不可用，可在设置中配置自己的API Key：
1. 点击右上角设置按钮
2. 在"AI设置"区域选择服务商（Gemini/DeepSeek）
3. 输入API Key
4. 点击"保存AI配置"

---

## 系统设置

点击右上角齿轮图标打开设置面板。

### AI设置

- **服务商选择**: Gemini 或 DeepSeek
- **API Key**: 输入您的API密钥
- 留空则使用系统默认配置
- 配置保存在浏览器本地存储

### 主题设置

- **浅色**: 白色背景
- **深色**: 深色背景
- **跟随系统**: 自动跟随操作系统设置

### 数据管理

- **导出备份**: 下载包含所有数据的JSON文件
- **恢复备份**: 上传备份文件恢复数据

> **备份内容**: 订单、库存、产线、款号、异常记录

### 快捷键说明

显示系统支持的快捷键列表。

---

## 常见问题

### Q: 如何添加新产线？

A: 在排产控制页面，点击右上角"添加产线"按钮，输入产线名称即可。新产线默认为停机状态。

### Q: 产线分支是什么？

A: 一条产线可以同时生产两种规格（大管/小管），每个分支独立设置款号和产能。主线产能等于分支产能之和。

### Q: 大单的判定标准是什么？

A: 单笔订单超过100吨自动标记为大单，会在仪表盘显示预警，需要点击"确认大货"按钮确认已知悉。

### Q: 库存满足率如何计算？

A: 满足率 = (可用库存 + 今日产能) / 订单需求 × 100%

### Q: 为什么有些订单状态不能选？

A: 当库存满足率不足100%时，"齐料待发"和"已出货"状态会被禁用，需要先补足库存或增加产能。

### Q: AI功能不可用怎么办？

A: 
1. 检查网络连接
2. 在设置中配置自己的API Key（支持Gemini和DeepSeek）
3. 确保API Key有效且有足够配额

### Q: 数据保存在哪里？

A: 数据保存在服务器的SQLite数据库中（server/db/syncflow.db），所有修改自动保存。服务器每天凌晨3点自动备份。

### Q: 如何在日历视图中调整订单发货日期？

A: 直接拖拽订单到目标日期即可，会自动打开编辑弹窗确认修改。

### Q: 库存的优等品和一等品有什么区别？

A: 这是库存分级管理功能，优等品（A级）和一等品（B级）分开统计，入库出库时需要选择等级。

### Q: 如何查看某个款号的库存变动历史？

A: 在仓库作业的库存管理中，点击对应款号的"流水"按钮，可查看该款号的所有入库/出库记录。

### Q: 库存锁定有什么用？

A: 库存锁定用于预留库存给特定订单，锁定后的库存不会被其他订单占用。可以填写锁定原因便于追溯。

### Q: 安全库存是什么？

A: 安全库存是库存预警阈值，当某款号库存低于安全库存时，系统会在库存管理页面顶部显示预警提示。

### Q: 盘点调整和普通出入库有什么区别？

A: 盘点调整用于修正库存差异，流水记录会显示为"盘点入库"或"盘点出库"，与普通的"入库"/"出库"区分，便于审计追溯。

### Q: 如何查看库存操作的审计记录？

A: 在库存管理页面点击"日志"按钮，可查看所有盘点调整、锁定、解锁操作的详细记录，包括操作前后的数值变化。

### Q: 订单发货会自动扣减库存吗？

A: 是的，在待装车页面点击"确认装车"时，系统会自动扣减对应款号的库存，并记录出库流水。

### Q: 如何使用客户管理功能？

A: 在订单管理页面切换到"客户管理"视图。点击"同步"按钮可从订单中自动提取客户信息，也可手动添加客户。选中客户后可查看统计数据和历史订单。

### Q: 订单表格如何多列排序？

A: 按住Shift键点击列标题可进行多列排序，列标题旁会显示排序优先级数字。普通点击则为单列排序。

### Q: 如何拖拽导入订单？

A: 在导入订单弹窗中选择"上传文件"模式，直接将Excel文件拖入虚线框区域即可，拖拽时边框会变为绿色提示。

---

## 技术支持

如有问题，请联系系统管理员。
