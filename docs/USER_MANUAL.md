# SyncFlow 用户使用手册

## 目录

1. [系统概述](#系统概述)
2. [仪表盘](#仪表盘)
3. [订单管理](#订单管理)
4. [排产控制](#排产控制)
5. [仓库作业](#仓库作业)
6. [AI助手](#ai助手)
7. [常见问题](#常见问题)

---

## 系统概述

SyncFlow 是一个智能产销协同平台，帮助企业高效管理库存、订单与产线。

### 核心功能

| 模块 | 功能 | 说明 |
|------|------|------|
| 仪表盘 | 数据总览 | 实时监控关键指标 |
| 订单管理 | 订单导入/编辑/状态 | 支持Excel和AI导入，状态流转 |
| 排产控制 | 产线/款号管理 | 分支产能配置 |
| 仓库作业 | 装车/异常 | 发货确认和问题登记 |
| AI助手 | 智能分析 | 排产建议、库存预警 |

### 界面布局

- **左侧边栏**: 导航菜单，可收缩
- **顶部**: 当前模块标题、语言切换、日期
- **主内容区**: 各模块功能界面
- **右下角**: AI助手入口

---

## 仪表盘

### 关键指标卡片

顶部显示4个核心指标：
- **活跃订单**: 待处理订单数量
- **待发吨数**: 未发货订单总吨数
- **运行产线**: 当前运行中的产线数（含分支产能汇总）
- **紧急预警**: 需要关注的预警数量

### 大单预警区

- 红色区域显示超过100吨的大订单
- 点击"确认大货"按钮确认已知悉
- 显示提前备货天数建议

### 库存健康度

- 右侧面板显示各款号库存覆盖率
- 绿色: 库存充足 (>100%)
- 黄色: 库存紧张 (50-100%)
- 红色: 库存不足 (<50%)

### 发货排程

- 今日发货: 当天需要装车的订单
- 即将发货: 未来几天的发货计划
- 显示装货时间段（上午/下午/灵活）

---

## 订单管理

### 标签页切换

订单管理分为三个标签页：
- **待处理**: 显示所有未出货订单（待处理、生产中、齐料待发）
- **待发货**: 仅显示齐料待发状态的订单
- **已出货**: 显示已完成发货的订单

### 订单状态流转

| 状态 | 说明 | 可切换条件 |
|------|------|------------|
| 待处理 | 新订单默认状态 | 无限制 |
| 生产中 | 订单已安排生产 | 无限制 |
| 齐料待发 | 物料齐全待发货 | 满足率≥100% |
| 已出货 | 订单已发货完成 | 满足率≥100% |

> 注意: 库存满足率不足100%时，"齐料待发"和"已出货"状态不可选

### 导入订单

#### 方式一: Excel导入

1. 点击绿色"导入订单"按钮
2. 选择"粘贴数据"或"上传文件"
3. Excel列顺序：
   - 日期、客户、款号、PI号、产线、提单号
   - 总量(t)、柜数、包/柜、港口、对接人
   - 贸易类型、装货要求
4. 点击"解析预览"检查数据
5. 确认无误后点击"确认导入"

#### 方式二: AI智能导入

1. 点击"从聊天导入(AI)"按钮
2. 粘贴文本内容
3. AI自动提取订单信息
4. 确认后添加到系统

### 订单列表

| 列 | 说明 |
|---|---|
| 日期 | 订单日期 |
| 客户 | 客户名称，大单显示红色标签 |
| 款号 | 产品款号，显示分配产线 |
| 总量 | 订单吨数，底部显示合计 |
| 柜数 | 集装箱数量 |
| 港口 | 目的港 |
| 状态 | 订单当前状态（可切换） |
| 满足率 | 库存满足订单的百分比 |
| 操作 | 编辑、删除、展开详情 |

> 注意: 已出货订单不可编辑和删除

### 编辑订单

点击订单行右侧的编辑图标，可修改：
- 基本信息（日期、客户、款号等）
- 物流信息（港口、提单号等）
- 装货要求

---

## 排产控制

### 顶部总览

显示关键生产指标（实时更新）：
- **总产线数**: 系统中的产线总数
- **运行中**: 当前运行的产线数
- **总产能/日**: 运行产线的日产能合计（含分支）
- **外贸可用/日**: 可用于外贸的产能
- **款号数量**: 款号维护表中的款号数

### 款号产能分布

点击展开查看每个在产款号的详情：
- 产线数: 生产该款号的产线数量（含分支）
- 总产能: 该款号的日产能合计
- 外贸可用: 可用于外贸的产能
- 产线列表: 具体哪些产线/分支在生产

### 产线管理

#### 产线卡片

每个产线显示：
- 产线名称和状态指示灯
- 当前款号（可快速切换）
- 产能和外贸产能（可快速修改）
- 历史按钮（查看款号变更记录）

#### 快速操作

在产线卡片上可直接：
- 点击款号下拉框快速切换款号
- 点击产能数值快速修改产能
- 点击外贸产能数值快速修改

#### 编辑产线

点击产线卡片进入编辑：

1. **基本设置**
   - 产线名称
   - 状态: 运行中/维护中/停机

2. **无分支模式**
   - 直接设置款号、产能、外贸产能

3. **分支模式**
   - 点击"+大管"或"+小管"添加分支
   - 每个分支独立设置款号、产能、外贸产能
   - 主线产能 = 分支产能之和
   - 最多两个分支（大管+小管）
   - 已添加的分支类型不可重复添加

#### 款号变更历史

点击"历史"按钮查看：
- 主线变更: `旧款号 → 新款号`
- 分支变更: `大管:旧款号 → 大管:新款号`
- 变更时间精确到分钟

### 款号维护

切换到"款号维护"标签页：

| 字段 | 说明 |
|---|---|
| 款号 | 产品编号（必填） |
| 名称 | 产品名称 |
| 分类 | 产品分类（如A类/B类） |
| 单位重量 | 每件重量(kg) |
| 备注 | 其他说明 |

> 注意: 产线使用的款号会自动添加到款号维护表

---

## 仓库作业

### 待装货列表

显示所有待发货订单：
- 按发货日期排序
- 显示客户、款号、吨数、柜数
- 显示装货时间段

### 确认装车

1. 找到要发货的订单
2. 点击"确认装车"按钮
3. 订单状态变为"已发货"

### 异常登记

遇到问题时登记异常：

1. 点击"登记异常"按钮
2. 选择款号和原因类型：
   - 库存被取用
   - 质量问题
   - 数量差异
   - 其他
3. 填写详细说明
4. 提交登记

### 车间沟通

更新与车间的沟通状态：
1. 点击订单的沟通状态按钮
2. 选择新状态
3. 填写备注（可选）
4. 保存更新

---

## AI助手

### 打开AI助手

点击页面右下角的蓝色机器人按钮

### 快捷分析

| 功能 | 说明 |
|---|---|
| 排产建议 | 分析订单和产能（含分支），给出产线分配建议 |
| 库存分析 | 预测库存缺口，建议补货优先级 |
| 异常分析 | 总结异常模式，分析根本原因 |
| 发货排序 | 根据交期、库存智能排定优先级 |

### 自然语言查询

直接输入问题，例如：
- "BE3250库存够吗？"
- "今天有哪些订单要发？"
- "哪条产线产能最高？"
- "大单有哪些？"

AI会根据系统数据给出精准回答。

---

## 常见问题

### Q: 如何添加新产线？

A: 在排产控制页面，点击右上角"添加产线"按钮，输入产线名称即可。

### Q: 产线分支是什么？

A: 一条产线可以同时生产两种规格（大管/小管），每个分支独立设置款号和产能。每条主线最多两个分支。

### Q: 大单的判定标准是什么？

A: 单笔订单超过100吨自动标记为大单，需要点击确认已知悉。

### Q: 库存满足率如何计算？

A: 满足率 = (可用库存 + 预计产出) / 订单需求 × 100%

### Q: 为什么有些订单状态不能选？

A: 当库存满足率不足100%时，"齐料待发"和"已出货"状态会被禁用，需要先补足库存。

### Q: AI功能需要配置什么？

A: 需要在 `.env.local` 文件中配置 `API_KEY` 为有效的 Gemini API Key。

### Q: 数据保存在哪里？

A: 数据保存在 `server/db/syncflow.db` SQLite数据库文件中，所有修改自动保存。

---

## 快捷键

| 快捷键 | 功能 |
|---|---|
| 点击侧边栏收缩按钮 | 折叠/展开侧边栏 |
| 点击订单行 | 展开/收起订单详情 |
| 点击产线卡片 | 打开产线编辑 |

---

## 技术支持

如有问题，请联系系统管理员。
